<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenHornet: Software Manual</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">OpenHornet
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_software_docs__software_manual.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Software Manual </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >This manual is about writing software for the OpenHornet project. It shows how to write, document and test your software.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Supported Hardware</h1>
<ul>
<li>Arduino MEGA</li>
<li>Arduino Nano</li>
</ul>
<h1><a class="anchor" id="autotoc_md2"></a>
Prerequisites</h1>
<ul>
<li>Arduino IDE (with Libraries listed below)</li>
<li>Local Doxygen installation</li>
<li>OpenHornetSandbox access</li>
</ul>
<h1><a class="anchor" id="autotoc_md3"></a>
Supported Software</h1>
<ul>
<li>Arduino 1.8.10</li>
<li>DCS-bios 0.10.0</li>
<li>Doxygen 1.8.13</li>
</ul>
<h2><a class="anchor" id="autotoc_md4"></a>
Arduino Libraries</h2>
<ul>
<li>dcs-bios-arduino-library 0.2.11</li>
</ul>
<h1><a class="anchor" id="autotoc_md5"></a>
Preparation</h1>
<p >The starting point of every new software sketch is the OHSketchTemplate folder. Please copy the whole folder. There are some test.skip files inside there who are needed for the travis-ci testing. Once copied delete the sample function from the <a class="el" href="_o_h_sketch_template_8ino.html">OHSketchTemplate.ino</a>. Then change all the @tags with your own information.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Sketch naming</h1>
<p >The Sketches are named according to the System Architecture drawing found in the OH documentation. The first part of the name is the OH No. found in the drawing. It is the number beneath the Board type.</p>
<p >e.g: 1A2A for the Master Arm Panel. (Not 1A2A1A).</p>
<p >The No. is followed by a minus sign "-" (without space). Then the name of the component the sketch is for. The name is written in uppercase and with underscores "\_" instead of spaces.</p>
<p >e.g: 1A2A-MASTER_ARM_PANEL for the Master Arm Panel.</p>
<p >If the Sketch is for more than one component. Meaning that the board controls more than one component, use the name of the first component the sketch is for (the upper most component in the System Architecture drawing).</p>
<h1><a class="anchor" id="autotoc_md7"></a>
Documenting Software with Doxygen</h1>
<p >It is imperative that all the code you write is documented. We use doxygen as API documentation generator. So all the comments have to be doxygen compatible. Otherwise they will not show up in the documentation.</p>
<p >We use Javadoc style comment markup. Since it is the easiest to read for humans.</p>
<p >The following is an example of how to document code:</p>
<h2><a class="anchor" id="autotoc_md8"></a>
File Header</h2>
<div class="fragment"><div class="line">/**************************************************************************************</div>
<div class="line"> *        ____                   _    _                       _</div>
<div class="line"> *       / __ \                 | |  | |                     | |</div>
<div class="line"> *      | |  | |_ __   ___ _ __ | |__| | ___  _ __ _ __   ___| |_</div>
<div class="line"> *      | |  | | &#39;_ \ / _ \ &#39;_ \|  __  |/ _ \| &#39;__| &#39;_ \ / _ \ __|</div>
<div class="line"> *      | |__| | |_) |  __/ | | | |  | | (_) | |  | | | |  __/ |_</div>
<div class="line"> *       \____/| .__/ \___|_| |_|_|  |_|\___/|_|  |_| |_|\___|\__|</div>
<div class="line"> *             | |</div>
<div class="line"> *             |_|</div>
<div class="line"> *</div>
<div class="line"> *</div>
<div class="line"> *   Project OpenHornet</div>
<div class="line"> *</div>
<div class="line"> *   The OpenHornet Project is a F/A-18C OFP 13C Lot 20 1:1 Replica Simulator,</div>
<div class="line"> *   consisting of a physical structure and electrical/software interfaces to a PC</div>
<div class="line"> *   to be driven by Digital Combat Simulator (DCS).</div>
<div class="line"> *</div>
<div class="line"> *   ---------------------------------------------------------------------------------</div>
<div class="line"> *</div>
<div class="line"> *   This Project is released under the Creative Commons</div>
<div class="line"> *   Atribution - Non Comercal - Share Alike License.</div>
<div class="line"> *</div>
<div class="line"> *   CC BY-NC-SA 3.0</div>
<div class="line"> *</div>
<div class="line"> *   You are free to:</div>
<div class="line"> *   - Share — copy and redistribute the material in any medium or format</div>
<div class="line"> *   - Adapt — remix, transform, and build upon the material</div>
<div class="line"> *   The licensor cannot revoke these freedoms as long as you follow the license terms.</div>
<div class="line"> *</div>
<div class="line"> *   Under the following terms:</div>
<div class="line"> *   - Attribution — You must give appropriate credit, provide a link to the license,</div>
<div class="line"> *     and indicate if changes were made. You may do so in any reasonable manner,</div>
<div class="line"> *     but not in any way that suggests the licensor endorses you or your use.</div>
<div class="line"> *   - NonCommercial — You may not use the material for commercial purposes.</div>
<div class="line"> *   - ShareAlike — If you remix, transform, or build upon the material,</div>
<div class="line"> *     you must distribute your contributions under the same license as the original.</div>
<div class="line"> *</div>
<div class="line"> *   No additional restrictions — You may not apply legal terms or technological</div>
<div class="line"> *   measures that legally restrict others from doing anything the license permits.</div>
<div class="line"> *</div>
<div class="line"> *   More Information about the license can be found under:</div>
<div class="line"> *   https://creativecommons.org/licenses/by-nc-sa/3.0/</div>
<div class="line"> *</div>
<div class="line"> *   ---------------------------------------------------------------------------------</div>
<div class="line"> *</div>
<div class="line"> *   The OpenHornet Software is based on DCS-BIOS</div>
<div class="line"> *   You can find more information here: http://dcs-bios.a10c.de</div>
<div class="line"> *</div>
<div class="line"> *   DCS-BIOS is released under the following terms:</div>
<div class="line"> *   https://github.com/dcs-bios/dcs-bios/blob/develop/DCS-BIOS-License.txt</div>
<div class="line"> *</div>
<div class="line"> *   ---------------------------------------------------------------------------------</div>
<div class="line"> *</div>
<div class="line"> *   This Project uses Doxygen as a documentation generator.</div>
<div class="line"> *   Please use Doxigen capable comments.</div>
<div class="line"> *</div>
<div class="line"> **************************************************************************************/</div>
</div><!-- fragment --><p> This is the standard file header of OH. It has to be used as is in every sketch written for the OH Software.</p>
<h2><a class="anchor" id="autotoc_md9"></a>
Sketch Summary</h2>
<p >The Sketch summary comments should be on top of the file, right after the Header and looks like this: </p><div class="fragment"><div class="line">/**</div>
<div class="line"> * @file OHSketchTemplate.ino</div>
<div class="line"> * @author Balz Reber</div>
<div class="line"> * @date 22.11.2019</div>
<div class="line"> * @version 0.0.1 (untested)</div>
<div class="line"> * @warning This sketch is not yet tested on hardware</div>
<div class="line"> * @brief This is the OpenHornet Sketch Template</div>
<div class="line"> *</div>
<div class="line"> * @details This is the Open Hornet Sketch Template. It should be used as a starting point for every new sketch.</div>
<div class="line"> * Please copy the whole OHSketchTemplate folder to start. As it also contains some test skip files needed for travis.</div>
<div class="line"> */</div>
</div><!-- fragment --><p> The elements in the summary are the following:</p>
<h3><a class="anchor" id="autotoc_md10"></a>
File</h3>
<p >The @file has to have the exact same name as the filename. Including the file extension.</p>
<h3><a class="anchor" id="autotoc_md11"></a>
Author</h3>
<p >The author of the Sketch. If more than one person was working on the sketch, the authors shall be listed in a comma separated list. With the original author at first place.</p>
<h3><a class="anchor" id="autotoc_md12"></a>
Date</h3>
<p >The date the sketch was last modified.</p>
<h3><a class="anchor" id="autotoc_md13"></a>
Version</h3>
<p >The version of the sketch. To see how the versioning of sketches works, see "Versioning" in this document.</p>
<h3><a class="anchor" id="autotoc_md14"></a>
Warning</h3>
<p >Every untested sketch has to have a "This sketch is based on a wiring diagram, and was not yet tested on hardware" warning.</p>
<h3><a class="anchor" id="autotoc_md15"></a>
Brief</h3>
<p >A brief description of the sketch.</p>
<h3><a class="anchor" id="autotoc_md16"></a>
Detail</h3>
<p >A more detailed description of the sketch</p>
<h2><a class="anchor" id="autotoc_md17"></a>
Functions</h2>
<p >Function documentations should look like this:</p>
<div class="fragment"><div class="line">/**</div>
<div class="line">* A brief description on a single line, ended by a period or blank line.</div>
<div class="line">*</div>
<div class="line">* A longer comment, which may stretch over several lines and may include other things like:</div>
<div class="line">* - a list like this</div>
<div class="line">* - special markup like below</div>
<div class="line">*</div>
<div class="line">* @param myParam1 Description of 1st parameter.</div>
<div class="line">* @param myParam2 Description of 2nd parameter.</div>
<div class="line">* @returns Description of returned value.</div>
<div class="line">*/</div>
<div class="line">int sampleFunction(int myParam1, int myParam2) {</div>
<div class="line">  return myReturn;</div>
<div class="line">}</div>
</div><!-- fragment --><p> Doxygen then takes this and generates a Function documentation looking like this:</p>
<p ><img src="https://raw.githubusercontent.com/jrsteensen/OpenHornet/master/images/Logo/open_hornet_avatar.png" alt="IMAGE" class="inline"/></p>
<p >Functions should be commented as seen above. It is important that every function you write is commented like this. Otherwise it will not show up in the API documentation. The comment structure is as followed:</p>
<h3><a class="anchor" id="autotoc_md18"></a>
Brief</h3>
<div class="fragment"><div class="line">/**</div>
<div class="line">* A brief description on a single line, ended by a period or blank line.</div>
</div><!-- fragment --><p> The comment has to start with <code>/**</code> and then a new line with a single <code>*</code>. Then you write a very short description of what the function will do. The short description has to end with a dot <code>.</code> or a blank like.</p>
<h3><a class="anchor" id="autotoc_md19"></a>
Description</h3>
<div class="fragment"><div class="line">* A longer comment, which may stretch over several lines and may include other things like:</div>
<div class="line">* - a list like this</div>
<div class="line">* - special markup like below</div>
</div><!-- fragment --><p> This is the main description of your function. Write in detail what your function does.</p>
<h3><a class="anchor" id="autotoc_md20"></a>
Parameters</h3>
<div class="fragment"><div class="line">* @param myParam1 Description of 1st parameter.</div>
<div class="line">* @param myParam2 Description of 2nd parameter.</div>
</div><!-- fragment --><p> Each parameter the function uses is documented with a <code>@param</code> tag. After the tag there is a space and then the name of the parameter. Then another space and then the description of the parameter.</p>
<h3><a class="anchor" id="autotoc_md21"></a>
Return</h3>
<div class="fragment"><div class="line">* @returns Description of returned value.</div>
</div><!-- fragment --><p> The return parameter, if there is any, is documented with a <code>@returns</code> parameter. The return parameter needs no name. So after a space you can write the description of the parameter.</p>
<h3><a class="anchor" id="autotoc_md22"></a>
Other Comments</h3>
<div class="fragment"><div class="line">// Takes the input var and duplicates it. Writes the result in a newly created result var of type int.</div>
<div class="line">int result = 2 * input</div>
</div><!-- fragment --><p> The insides of a function are a black box to doxygen. It is important that you comment the code inside a function nevertheless. This has to be done for other coders who might have to work with your code. Comments inside a function are done with a simple <code>//</code> before the comment.</p>
<h1><a class="anchor" id="autotoc_md23"></a>
Slave ID</h1>
<p >All sketches who run as slave on the RS485 bus have to have a slave ID (DCSBIOS_RS485_SLAVE). That slave ID has to be unique on the RS485 bus the sketch runs on. But they can be the same for different buses (Every RS485 master has it's own bus). The slave ID is given according to the last number in the sketch number.</p>
<p >e.g 1A2A (Master Arm Panel) has to have the slave ID 2 e.g 1A4A (L Warning Indicator) has to have the slave ID 4</p>
<h1><a class="anchor" id="autotoc_md24"></a>
Versioning</h1>
<p >The version number consists of three digits.</p>
<p >eg: 1.4.2</p>
<p >Those three numbers are release.feature.change</p>
<ul>
<li>The last number has to be changed every time there was a change to the sketch. No matter how miniscule.</li>
<li>The middle number has to be changed every time there is a new complete feature inside the sketch.</li>
<li>The leading number is only for releases. So only changes if there was a new release of the sketch.</li>
<li>If any number changes, all subsequent numbers are reset to 0.</li>
</ul>
<p >Sketches who are untested have to have a leading "u" before the version number and "(untested)" behind the version no.</p>
<p >eg: u.1.4.2 (untested)</p>
<h1><a class="anchor" id="autotoc_md25"></a>
Testing your Software</h1>
<p >Before you upload anything, please check if your sketch compiles in your Arduino editor. If it does, check if doxygen compiles with your local doxygen installation.</p>
<p >Once those local tests are successfully, upload your sketch to the <a href="https://balzreber.github.io/OpenHornetSandbox/">OpenHornet Sandbox</a> and see if the <a href="http://www.ravis-ci.org">travis-ci</a> tests are successful. If they are, your sketch is ready to be uploaded to the <a href="https://github.com/jrsteensen/OpenHornet">main repo</a>.</p>
<p >(The OpenHornet Sandbox should be seen as an extension of local testing. Be aware that this is only a Sandbox. Code will not persist there and can be removed at any time.)</p>
<p >You can get access to the OpenHornet Sandbox by asking Balse (Balse#3320 on Discord).</p>
<h1><a class="anchor" id="autotoc_md26"></a>
Travis-CI</h1>
<p >Travis CI is a continuous integration testing engine. It is connected with the OpenHornet Sandbox (and with the main repo). If Travis detects a change in the repo, it automatically starts working. Basically it starts a virtual environment, clones the repo into that environment and then tries to compile the code. If the code compiles successfully and there where no errors detected, it automatically updates the Doxygen documentation and uploads it back to the repo.</p>
<p >Travis uses a Adafruit script to carry out its tests. You can find the script here: <a href="https://github.com/adafruit/travis-ci-arduino">Travis-CI-Arduino</a></p>
<h2><a class="anchor" id="autotoc_md27"></a>
Tested Platforms</h2>
<p >By default Travis tests the code on the following platforms:</p>
<ul>
<li>Arduino UNO (uno)</li>
<li>Arduino MEGA (mega)</li>
<li>Arduino Zero (zero)</li>
<li>Arduino Leonardo (leonardo)</li>
<li>ESP8266 (esp8266)</li>
<li>ESP32 (esp32)</li>
<li>Adafruit Metro M4 (m4)</li>
</ul>
<p >Since OpenHornet only uses Arduino NANO (same as Arduino UNO for testing) and Arduino MEGA, all other tests should be skipped. This is done by including a *.test.skip file inside the directory the sketch resides. For example: esp8266.test.skip would skip the ESP8266 test. The necessary *.test.skip files are included in the sketch template folder.</p>
<p >Make sure that you include a uno.test.skip file for sketches who can only run on Arduino MEGA. Like the RS485 bus masters for example.</p>
<h2><a class="anchor" id="autotoc_md28"></a>
Arduino Libraries</h2>
<p >Arduino Libraries who are included in your sketch need to be installed inside travis in order for the tests to work. You find a list of already included libraries in the "Supported Software" section of this manual. If you need anther library installed, ask Balse (Balse#3320 on Discord). He will install the library for you.</p>
<h1><a class="anchor" id="autotoc_md29"></a>
Resources</h1>
<ul>
<li><a href="https://learn.adafruit.com/the-well-automated-arduino-library/travis-ci">https://learn.adafruit.com/the-well-automated-arduino-library/travis-ci</a></li>
<li><a href="https://github.com/adafruit/travis-ci-arduino">https://github.com/adafruit/travis-ci-arduino</a></li>
<li><a href="http://www.doxygen.org">http://www.doxygen.org</a></li>
<li><a href="http://www.ravis-ci.org">http://www.ravis-ci.org</a></li>
<li><a href="https://github.com/dcs-bios">https://github.com/dcs-bios</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
